drop schema econtactschema cascade;
create schema econtactschema;

CREATE TABLE econtactschema.access_church (id numeric(38,0) NOT NULL, version bigint, add_contact_permit boolean NOT NULL, confirm boolean NOT NULL, adit_access_permit boolean NOT NULL, edit_contact_permit boolean NOT NULL, edit_group_permit boolean NOT NULL, edit_permit boolean NOT NULL, edit_user_permit boolean NOT NULL, sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone  NOT NULL, view_permit boolean NOT NULL, id_church_fk numeric(38,0) NOT NULL, id_user_fk numeric(38,0) NOT NULL, CONSTRAINT access_church_pkey PRIMARY KEY (id) );
CREATE TABLE econtactschema.access_group ( id numeric(38,0) NOT NULL, version bigint, confirm boolean NOT NULL, edit_permit boolean NOT NULL, register_permit boolean NOT NULL, sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone  NOT NULL, view_permit boolean NOT NULL, id_group_fk numeric(38,0) NOT NULL, id_user_fk numeric(38,0) NOT NULL, CONSTRAINT access_group_pkey PRIMARY KEY (id) );
CREATE TABLE econtactschema.address ( id numeric(38,0) NOT NULL, version bigint, city varchar(200), country varchar(200), flat varchar(50), "number" varchar(50), region varchar(200), sign numeric(38,0) NOT NULL, state varchar(200), street varchar(200), upd_author varchar(200) NOT NULL, upd_date timestamp without time zone  NOT NULL, zip varchar(50), CONSTRAINT address_pkey PRIMARY KEY (id) );
CREATE TABLE econtactschema.audit_rev (id int8 not null, date_ev timestamp without time zone not null, name_ev varchar(300), note varchar(1000), time_stamp int8, id_user_fk numeric(38,0) , primary key (ID));
CREATE TABLE econtactschema.audit_rev_changed (id int8 not null, entity_id varchar(100), entity_name varchar(300) not null, id_audit_rev_fk int8 not null, primary key (ID));
CREATE TABLE econtactschema.church ( id numeric(38,0) NOT NULL, version bigint, create_date timestamp without time zone NOT NULL, description_church varchar(1000), name_church varchar(255) NOT NULL, sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone NOT NULL, id_owner_fk numeric(38,0), CONSTRAINT church_pkey PRIMARY KEY (id) );
CREATE TABLE econtactschema.church_aud ( id numeric(38,0) NOT NULL, rev bigint NOT NULL, revtype smallint, create_date timestamp without time zone, description_church varchar(1000), name_church varchar(255), sign numeric(38,0), upd_author varchar(200), upd_date timestamp without time zone, CONSTRAINT church_aud_pkey PRIMARY KEY (id, rev));
CREATE TABLE econtactschema.connect_audit ( id numeric(38,0) NOT NULL, devicename varchar(500) NOT NULL, endvisit timestamp without time zone, ipaddress varchar(100) NOT NULL, sessionid varchar(100) NOT NULL, startvisit timestamp without time zone NOT NULL, id_user_fk numeric(38,0) NOT NULL, CONSTRAINT connect_audit_pkey PRIMARY KEY (id));
CREATE TABLE econtactschema.contact ( id numeric(38,0) NOT NULL, version bigint, sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone NOT NULL, value varchar(255), id_person_fk numeric(38,0) NOT NULL, id_type_ud_fk numeric(38,0) NOT NULL, CONSTRAINT contact_pkey PRIMARY KEY (id));
CREATE TABLE econtactschema."group" ( id numeric(38,0) NOT NULL, version bigint, description varchar(2000), name varchar(200) NOT NULL, sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone NOT NULL, id_church_fk numeric(38,0) NOT NULL, CONSTRAINT group_pkey PRIMARY KEY (id));
CREATE TABLE econtactschema.group_aud ( id numeric(38,0) NOT NULL, rev bigint NOT NULL,  revtype smallint, description varchar(2000), name varchar(200), sign numeric(38,0), upd_author varchar(200), upd_date timestamp without time zone, CONSTRAINT group_aud_pkey PRIMARY KEY (id, rev));
CREATE TABLE econtactschema.person ( id numeric(38,0) NOT NULL, version bigint, birthday timestamp without time zone, first_name varchar(100), last_name varchar(100), middle_name varchar(100), sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone NOT NULL, id_address_fk numeric(38,0), id_age_range_ud_fk numeric(38,0), id_status_ud_fk numeric(38,0), CONSTRAINT person_pkey PRIMARY KEY (id));
CREATE TABLE econtactschema.univer_dict ( id numeric(38,0) NOT NULL, version bigint, abr_rec_dict varchar(40), id_rec_dict integer NOT NULL, name_rec_dict varchar(200) NOT NULL, param_dict varchar(40) NOT NULL, sign numeric(38,0) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone NOT NULL, CONSTRAINT univer_dict_pkey PRIMARY KEY (id));
CREATE TABLE econtactschema.univer_dict_aud ( id numeric(38,0) NOT NULL, rev bigint NOT NULL, revtype smallint, abr_rec_dict varchar(40), id_rec_dict integer, name_rec_dict varchar(200), param_dict varchar(40), sign numeric(38,0), upd_author varchar(200), upd_date timestamp without time zone, CONSTRAINT univer_dict_aud_pkey PRIMARY KEY (id, rev));
CREATE TABLE econtactschema.user_account ( id numeric(38,0) NOT NULL, version bigint, login varchar(100) NOT NULL, role varchar(255) NOT NULL, sign numeric(38,0) NOT NULL, allow_create_register boolean NOT NULL, enableduser integer NOT NULL, first_name varchar(100) NOT NULL, last_name varchar(100) NOT NULL, password varchar(100) NOT NULL, role_confirm integer NOT NULL, salt varchar(40) NOT NULL, upd_author varchar(200) NOT NULL, upd_date timestamp without time zone NOT NULL, id_parent_user_fk numeric(38,0), CONSTRAINT user_account_pkey PRIMARY KEY (id));
CREATE TABLE econtactschema.user_account_aud ( id numeric(38,0) NOT NULL, rev bigint NOT NULL, revtype smallint, login varchar(100), role varchar(255), sign numeric(38,0), allow_create_register boolean, enableduser integer, first_name varchar(100), last_name varchar(100), password varchar(100), role_confirm integer, salt varchar(40), upd_author varchar(200), upd_date timestamp without time zone, CONSTRAINT user_account_aud_pkey PRIMARY KEY (id, rev));

alter table econtactschema.access_church add constraint fk_15b16jv8ws9t1dil7iytawcrg foreign key (id_church_fk) references econtactschema.church (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.access_church add constraint fk_gvi6e3brbth44gm4rwv2yyyw0 foreign key (id_user_fk) references econtactschema.user_account (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.access_church add constraint access_church_1 UNIQUE (id_user_fk, id_church_fk, sign);
alter table econtactschema.access_group add constraint fk_7yy9i9u1uv4h4srg7rjkks2vt foreign key (id_user_fk) references econtactschema.user_account (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.access_group add constraint fk_npusux8quqjjasyood59mo5aa foreign key (id_group_fk) references econtactschema."group" (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.audit_rev add constraint "fk$audit_rev__person" FOREIGN KEY (id_user_fk) REFERENCES econtactschema.user_account (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.audit_rev_changed add constraint "fk$audit_rev_changed__audit_rev" FOREIGN KEY (id_audit_rev_fk) REFERENCES econtactschema.audit_rev (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.church add constraint fk_757ki5d7l1bl5o0ssax9k6724 FOREIGN KEY (id_owner_fk) REFERENCES econtactschema.user_account (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.church add constraint church_1 UNIQUE (name_church, sign);
alter table econtactschema.church_aud add constraint fk_otcg2gekq9hkarjddxb39hl49 FOREIGN KEY (rev) REFERENCES econtactschema.audit_rev (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.connect_audit add constraint fk_knnlaqag3xeuff2ju9lmjn8ba FOREIGN KEY (id_user_fk) REFERENCES econtactschema.user_account (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.contact add constraint fk_5d5gjxwxj6ihea73fa4mr8w9c FOREIGN KEY (id_person_fk) REFERENCES econtactschema.person (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.contact add constraint fk_ajoxtadq2ll1hqo4frwjx5hs7 FOREIGN KEY (id_type_ud_fk) REFERENCES econtactschema.univer_dict (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema."group"  add constraint fk_op0m1m6oc6492l7x48ftu2hci FOREIGN KEY (id_church_fk) REFERENCES econtactschema.church (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.group_aud  add constraint fk_4vqqivgxd5xi0g15xa4g9k2ju FOREIGN KEY (rev) REFERENCES econtactschema.audit_rev (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.person add constraint fk_59levpt67niocwqvj2of51847 FOREIGN KEY (id_address_fk) REFERENCES econtactschema.address (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.person add constraint fk_lcb1g44r8nw8cny2vcyg4wnw7 FOREIGN KEY (id_status_ud_fk) REFERENCES econtactschema.univer_dict (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.person add constraint fk_pcw98fhds53bh92y0m4cj8lk FOREIGN KEY (id_age_range_ud_fk) REFERENCES econtactschema.univer_dict (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.univer_dict add constraint univer_dict_1 UNIQUE (sign, param_dict, id_rec_dict);
alter table econtactschema.univer_dict_aud add constraint fk_ap2bts0p38i7l35u0famtm1ow FOREIGN KEY (rev) REFERENCES econtactschema.audit_rev (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.user_account  add constraint fk_2fhx84ba6pnkawbhhvnncx7s7 FOREIGN KEY (id_parent_user_fk) REFERENCES econtactschema.user_account (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;
alter table econtactschema.user_account  add constraint account_user_1 UNIQUE (login, sign);
alter table econtactschema.user_account_aud  add constraint fk_8lr7bh3w6j3hgvum7422b017b FOREIGN KEY (rev) REFERENCES econtactschema.audit_rev (id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION;

CREATE SEQUENCE econtactschema.seq_access_church_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_access_group_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_address_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_audit_rev start 1 increment 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_audit_rev_chenged start 1 increment 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_church_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_connect_audit_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_contact_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_group_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_person_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_univer_dict_id INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE econtactschema.seq_user_id INCREMENT 1 START 1  MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;